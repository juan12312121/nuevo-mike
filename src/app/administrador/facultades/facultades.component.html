<div class="body">
  <div class="layout">
    <!-- Sidebar Component -->
    <app-aside-administrador></app-aside-administrador>

    <div class="main">
      <div class="content">
        <!-- Card Section -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">Facultades Registradas</h2>
            <button class="btn btn-primary" id="btn-nueva-facultad" (click)="openModal()">
              <i class="fas fa-plus btn-icon"></i> Nueva Facultad
            </button>
          </div>

          <!-- Filters Section -->
          <div class="filters">
            <div class="filter-group">
              <div class="search-input">
                <i class="fas fa-search search-icon"></i>
                <!-- Aquí agregamos el ngModel y el evento input -->
                <input
                  type="text"
                  class="search-field"
                  placeholder="Buscar facultad..."
                  [(ngModel)]="searchText"
                  (input)="searchFacultades()"
                />
              </div>
            </div>
            <div class="filter-group">
              <span class="filter-label">Escuela:</span>
              <!-- Este select es un filtro adicional, no lo modificaremos en este ejemplo -->
              <select class="form-select" style="width: 200px;">
                <option value="">Todas las escuelas</option>
                 <!-- Iterar sobre las escuelas cargadas si necesitas este filtro -->
                 <option *ngFor="let escuela of escuelas" [value]="escuela.id">{{ escuela.nombre }}</option>
              </select>
            </div>
          </div>

          <!-- Loading and Error Messages -->
          <div *ngIf="cargando" class="loading-message">Cargando facultades...</div>
          <div *ngIf="error" class="error-message">{{ error }}</div>

          <!-- Faculties Table Section -->
          <!-- La tabla itera sobre paginatedFacultades, que ya es la lista filtrada y paginada -->
          <div *ngIf="!cargando && paginatedFacultades.length > 0" class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Nombre de Facultad</th>
                  <th>Escuela</th>
                  <th>Descripción</th>
                  <th>Email de Contacto</th>
                  <th>Teléfono de Contacto</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let facultad of paginatedFacultades">
                  <td>{{ facultad.id }}</td>
                  <td>{{ facultad.nombre }}</td>
                  <td>{{ facultad.escuela_nombre }}</td>
                  <td>{{ facultad.descripcion }}</td>
                  <td>{{ facultad.email_contacto }}</td>
                  <td>{{ facultad.telefono_contacto }}</td>
                  <td>
                    <div class="table-actions">
                      <button class="btn-action btn-edit" title="Editar" (click)="editFacultad(facultad)">
                        <i class="fas fa-pen"></i>
                      </button>
                      <button (click)="eliminarFacultad(facultad)" class="btn-action btn-delete" title="Eliminar">
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- No Results Message -->
          <!-- Muestra este mensaje si la lista filtrada Y paginada está vacía Y no está cargando -->
          <div *ngIf="!cargando && paginatedFacultades.length === 0 && facultades.length === 0" class="no-results">
            No se encontraron facultades registradas que coincidan con la búsqueda.
          </div>
           <!-- Mensaje específico si la lista completa está vacía -->
          <div *ngIf="!cargando && originalFacultades.length === 0" class="no-results">
            No se encontraron facultades registradas.
          </div>


          <!-- Pagination Component -->
          <!-- El componente de paginación debe recibir la lista filtrada completa -->
          <app-paginacion-administrador
            [data]="facultades"
            [pageSize]="pageSize"
            [dataLabel]="'facultades'"
            (pageChanged)="onPageChange($event)">
          </app-paginacion-administrador>
        </div>
      </div>
    </div>

    <!-- Modal: edición / creación de facultad -->
    <app-modal-facultad
      [visible]="showModal"
      [facultadAEditar]="facultadAEditar"
      (close)="handleClose()"
      (save)="handleSave($event)">
    </app-modal-facultad>

  </div>
</div>
